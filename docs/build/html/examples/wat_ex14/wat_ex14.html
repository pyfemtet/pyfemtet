<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Heating element on the substrate &mdash; PyFemtet Project  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Air cooling of IC substrate" href="../paswat_ex1/paswat_ex1.html" />
    <link rel="prev" title="Resonant frequency of a circular patch antenna" href="../her_ex40/her_ex40.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            PyFemtet Project
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pages/installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../pages/examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../pages/examples.html#single-objective-optimization">Single Objective Optimization</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../pages/examples.html#multi-objective-optimization">Multi-Objective Optimization</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Heating element on the substrate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sample-file">Sample File</a></li>
<li class="toctree-l4"><a class="reference internal" href="#design-variables">Design Variables</a></li>
<li class="toctree-l4"><a class="reference internal" href="#objective-function">Objective Function</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sample-code">Sample Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="#execution-result-of-the-sample-code">Execution Result of the Sample Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../paswat_ex1/paswat_ex1.html">Air cooling of IC substrate</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../pages/examples.html#parallel-computing">Parallel Computing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pages/examples.html#cad-integration">CAD Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../pages/examples.html#constrained-model">Constrained Model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../pages/script_builder.html">GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pages/usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pages/api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pages/LICENSE.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PyFemtet Project</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../pages/examples.html">Examples</a></li>
      <li class="breadcrumb-item active">Heating element on the substrate</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/examples/wat_ex14/wat_ex14.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="heating-element-on-the-substrate">
<h1>Heating element on the substrate<a class="headerlink" href="#heating-element-on-the-substrate" title="Link to this heading"></a></h1>
<p>Using Femtet’s heat conduction analysis solver, we explain an example of searching for the substrate dimensions that minimize the size of the substrate while keeping the maximum temperature of an IC chip on the substrate to a minimum.</p>
<section id="sample-file">
<h2>Sample File<a class="headerlink" href="#sample-file" title="Link to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Keep the <a class="reference download internal" download="" href="../../_downloads/45c16116c2e98b68e3c514b136a33dd3/wat_ex14_parametric.femprj"><code class="xref download docutils literal notranslate"><span class="pre">sample</span> <span class="pre">project</span></code></a>
open in Femtet, and double-click on the <a class="reference download internal" download="" href="../../_downloads/f1664e6f51dfca51438de28f9f0f96ba/wat_ex14_parametric.py"><code class="xref download docutils literal notranslate"><span class="pre">sample</span> <span class="pre">code</span></code></a>
to execute it.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For details on the FEM problem, please refer to FemtetHelp / Examples / Heat Conduction Analysis / Example 14.</p>
</div>
</section>
<section id="design-variables">
<h2>Design Variables<a class="headerlink" href="#design-variables" title="Link to this heading"></a></h2>
<figure class="align-default" id="id1">
<img alt="../../_images/wat_ex14_model.png" src="../../_images/wat_ex14_model.png" />
<figcaption>
<p><span class="caption-text">Appearance of the Model</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Variable Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>substrate_w</p></td>
<td><p>Width of the substrate</p></td>
</tr>
<tr class="row-odd"><td><p>substrate_d</p></td>
<td><p>Depth of the substrate</p></td>
</tr>
</tbody>
</table>
</section>
<section id="objective-function">
<h2>Objective Function<a class="headerlink" href="#objective-function" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Maximum temperature of the main chip (to minimize)</p></li>
<li><p>Maximum temperature of the sub chip (to minimize)</p></li>
<li><p>Occupied area on the substrate plane (to minimize)</p></li>
</ul>
</section>
<section id="sample-code">
<h2>Sample Code<a class="headerlink" href="#sample-code" title="Link to this heading"></a></h2>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">wat_ex14_parametric.py</span><a class="headerlink" href="#id2" title="Link to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="sd">&quot;&quot;&quot;Multi-objective optimization: heating element on substrate.</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="sd">Using Femtet&#39;s heat conduction analysis solver, we will design</span>
<span class="linenos"> 4</span><span class="sd">to reduce the chip temperature and shrink the board size.</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="sd">Corresponding project: wat_ex14_parametric.femprj</span>
<span class="linenos"> 7</span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 8</span><span class="kn">from</span> <span class="nn">pyfemtet.opt</span> <span class="kn">import</span> <span class="n">FEMOpt</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="k">def</span> <span class="nf">chip_temp</span><span class="p">(</span><span class="n">Femtet</span><span class="p">,</span> <span class="n">chip_name</span><span class="p">):</span>
<span class="linenos">12</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Obtain the maximum temperature of the chip.</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="sd">    Note:</span>
<span class="linenos">15</span><span class="sd">        The objective or constraint function should take Femtet</span>
<span class="linenos">16</span><span class="sd">        as its first argument and return a float as the output.</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="sd">    Params:</span>
<span class="linenos">19</span><span class="sd">        Femtet: An instance for manipulating Femtet with macros. For detailed information, please refer to &quot;Femtet Macro Help&quot;.</span>
<span class="linenos">20</span><span class="sd">        chip_name (str): The body attribute name defined in femprj. Valid values are &#39;MAINCHIP&#39; or &#39;SUBCHIP&#39;.</span>
<span class="linenos">21</span>
<span class="linenos">22</span><span class="sd">    Returns:</span>
<span class="linenos">23</span><span class="sd">        float: The maximum temperature of the body with the specified body attribute name.</span>
<span class="linenos">24</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">25</span>    <span class="n">Gogh</span> <span class="o">=</span> <span class="n">Femtet</span><span class="o">.</span><span class="n">Gogh</span>
<span class="linenos">26</span>
<span class="linenos">27</span>    <span class="n">max_temperature</span><span class="p">,</span> <span class="n">min_temperature</span><span class="p">,</span> <span class="n">mean_temperature</span> <span class="o">=</span> <span class="n">Gogh</span><span class="o">.</span><span class="n">Watt</span><span class="o">.</span><span class="n">GetTemp</span><span class="p">(</span><span class="n">chip_name</span><span class="p">)</span>
<span class="linenos">28</span>
<span class="linenos">29</span>    <span class="k">return</span> <span class="n">max_temperature</span>  <span class="c1"># unit: degree</span>
<span class="linenos">30</span>
<span class="linenos">31</span>
<span class="linenos">32</span><span class="k">def</span> <span class="nf">substrate_size</span><span class="p">(</span><span class="n">Femtet</span><span class="p">):</span>
<span class="linenos">33</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the occupied area on the XY plane of the substrate.&quot;&quot;&quot;</span>
<span class="linenos">34</span>    <span class="n">substrate_w</span> <span class="o">=</span> <span class="n">Femtet</span><span class="o">.</span><span class="n">GetVariableValue</span><span class="p">(</span><span class="s1">&#39;substrate_w&#39;</span><span class="p">)</span>
<span class="linenos">35</span>    <span class="n">substrate_d</span> <span class="o">=</span> <span class="n">Femtet</span><span class="o">.</span><span class="n">GetVariableValue</span><span class="p">(</span><span class="s1">&#39;substrate_d&#39;</span><span class="p">)</span>
<span class="linenos">36</span>    <span class="k">return</span> <span class="n">substrate_w</span> <span class="o">*</span> <span class="n">substrate_d</span>  <span class="c1"># unit: mm2</span>
<span class="linenos">37</span>
<span class="linenos">38</span>
<span class="linenos">39</span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="linenos">40</span>
<span class="linenos">41</span>    <span class="c1"># Initialize the FEMOpt object.</span>
<span class="linenos">42</span>    <span class="c1"># (establish connection between the optimization problem and Femtet)</span>
<span class="linenos">43</span>    <span class="n">femopt</span> <span class="o">=</span> <span class="n">FEMOpt</span><span class="p">()</span>
<span class="linenos">44</span>
<span class="linenos">45</span>    <span class="c1"># Add design variables to the optimization problem.</span>
<span class="linenos">46</span>    <span class="c1"># (Specify the variables registered in the femprj file.)</span>
<span class="linenos">47</span>    <span class="n">femopt</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s2">&quot;substrate_w&quot;</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="linenos">48</span>    <span class="n">femopt</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s2">&quot;substrate_d&quot;</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=</span><span class="mi">33</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="linenos">49</span>
<span class="linenos">50</span>    <span class="c1"># Add the objective function to the optimization problem.</span>
<span class="linenos">51</span>    <span class="c1"># The target bending angle is 90 degrees.</span>
<span class="linenos">52</span>    <span class="n">femopt</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="n">chip_temp</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;max temp. of&lt;br&gt;MAINCHIP (degree)&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;minimize&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;MAINCHIP&#39;</span><span class="p">,))</span>
<span class="linenos">53</span>    <span class="n">femopt</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="n">chip_temp</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;max temp. of&lt;br&gt;SUBCHIP (degree)&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;minimize&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;SUBCHIP&#39;</span><span class="p">,))</span>
<span class="linenos">54</span>    <span class="n">femopt</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="n">substrate_size</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;substrate size&#39;</span><span class="p">)</span>
<span class="linenos">55</span>
<span class="linenos">56</span>    <span class="c1"># Run optimization.</span>
<span class="linenos">57</span>    <span class="n">femopt</span><span class="o">.</span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="linenos">58</span>    <span class="n">femopt</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">n_trials</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="execution-result-of-the-sample-code">
<h2>Execution Result of the Sample Code<a class="headerlink" href="#execution-result-of-the-sample-code" title="Link to this heading"></a></h2>
<figure class="align-default" id="id3">
<a class="reference internal image-reference" href="../../_images/wat_ex14_result.png"><img alt="../../_images/wat_ex14_result.png" src="../../_images/wat_ex14_result.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-text">Execution result of wat_ex14_parametric.py. This is a pair plot with the combination of each objective function on the vertical axis and horizontal axis.</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>From the results of the 20 trials, the following can be observed.</p>
<ul class="simple">
<li><p>The temperature of the main chip and the temperature of the sub chip can both be reduced by decreasing one of them.</p></li>
<li><p>Reducing the substrate size increases the temperature of the main chip.</p></li>
<li><p>Reducing the substrate size increases the temperature of the sub chip.</p></li>
</ul>
<p>From this, it can be seen that it is possible to design both the main chip and the sub chip to minimize temperature, but there is a trade-off relationship between the temperature of each chip and the substrate size, and it is understood that these minimizations are not compatible.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In multi-objective optimization, it is possible that the optimization of objective functions may not be compatible. In such cases, the designer needs to select the appropriate design from among the trade-off solutions.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since the physical reasons for these trade-offs cannot be derived from optimization algorithms, designers need to interpret the analysis results of Femtet.</p>
</div>
<p>In this problem, it can be inferred that the reduced substrate size has decreased the heat dissipation capacity to the environment, causing the chip temperature to rise because heat is not escaping from the substrate.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Results may vary slightly depending on the versions of Femtet, PyFemtet, and the optimization engine it depends on.</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../her_ex40/her_ex40.html" class="btn btn-neutral float-left" title="Resonant frequency of a circular patch antenna" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../paswat_ex1/paswat_ex1.html" class="btn btn-neutral float-right" title="Air cooling of IC substrate" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Kazuma Naito.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>